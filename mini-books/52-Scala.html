<div class="minilivro" id="mini52">
  <h2>Scala: A Língua da Magia por Trás do Motor Turbo Spark! 🗣️✨⚙️</h2>
  
  <p>Olá de novo, Desbravador(a) que fala a língua dos motores!</p>
  <p>
    <b>Scala</b> é a linguagem nativa do Apache Spark! Combina programação Orientada a Objetos (OOP) e Funcional (FP), roda na JVM, e é a base dos motores turbo do Big Data.
  </p>
  <div class="analogia">
    <b>Analogie:</b> Você pilota o Spark via PySpark 🐍🚢, mas SCALA é a LÍNGUA SECRETA E MÁGICA 🗣️✨ do motor Spark — como os engenheiros projetaram o funcionamento interno dele!
  </div>
  <p><b>Mental Trigger:</b> SCALA = Língua NATIVA do SPARK 🗣️⚙️.</p>

  <h3>Por Que a Língua do Motor é Importante?</h3>
  <ul>
    <li><b>Coração do Spark:</b> Entender Scala revela como o Spark funciona por dentro.</li>
    <li><b>Performance:</b> Código Scala Spark pode ser mais rápido para tarefas pesadas.</li>
    <li><b>Ecossistema:</b> Outras ferramentas Big Data (Kafka Streams, Akka) usam Scala.</li>
    <li><b>Construção de Ferramentas:</b> Para criar bibliotecas Spark customizadas.</li>
  </ul>

  <h3>Ferramentas e Magias Básicas em Scala 🛠️✨</h3>
  <ul>
    <li><b>val:</b> Variável imutável. <code>val nome: String = "Moeda"</code></li>
    <li><b>var:</b> Variável mutável. <code>var valor: Double = 10.5</code></li>
    <li><b>Funções:</b> <code>def soma(x: Int, y: Int): Int = x + y</code></li>
    <li><b>Funções anônimas:</b> <code>val dobrar = (x: Int) => x * 2</code></li>
    <li><b>Case Classes:</b> Para modelar dados imutáveis.
      <pre><code>
case class ItemTesouro(nome: String, valor: Double, local: String)
val tesouro = ItemTesouro("Moeda", 10.5, "Floresta")
      </code></pre>
    </li>
    <li><b>FP:</b> Imutabilidade, funções puras, "map/filter/reduce" em coleções.</li>
  </ul>

  <h3>Scala em Apache Spark: Programando o Motor Turbo! 🚢⚙️</h3>
  <pre><code class="language-scala">
// Exemplo básico
import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.functions._

val spark = SparkSession.builder().appName("ExemploScalaSpark").getOrCreate()
val df = spark.read.parquet("s3://meu-bucket/dados/vendas_raw.parquet")
val vendasValidas = df.filter($"valor" > 0 && $"quantidade" > 0)
                      .withColumn("valor_total", $"quantidade" * $"valor")
val totalPorProduto = vendasValidas.groupBy("produto")
                                  .agg(sum($"valor_total").alias("total_vendido"))
totalPorProduto.show(10)
  </code></pre>

  <h3>Scala vs. PySpark 🤔🐍↔️🗣️</h3>
  <ul>
    <li><b>Scala Spark:</b> API nativa, mais performática, tipagem estática, forte em FP.</li>
    <li><b>PySpark:</b> Mais fácil/interativo para quem já usa Python, ótimo para notebooks, integração com ecossistema Python.</li>
    <li><b>Quando usar cada:</b> Scala para desenvolvimento robusto/performance; PySpark para análise exploratória e integração Python DS.</li>
  </ul>

  <h3>Scala na Jornada de Dados 🗺️🗣️</h3>
  <ul>
    <li>Pipelines ETL/ELT de alta performance com Spark.</li>
    <li>Aplicações de streaming (Kafka Streams, Spark Streaming).</li>
    <li>Construção de sistemas de dados escaláveis.</li>
  </ul>

  <h3>Recapitulando Scala! 🧠🗣️✨⚙️</h3>
  <ul>
    <li>Linguagem OOP + FP, roda na JVM.</li>
    <li>Base do Spark; ótima para Big Data, performance, concorrência.</li>
    <li>Conceitos: val, var, case class, FP.</li>
    <li>Em Spark: API nativa, performance, construção de bibliotecas.</li>
    <li>Comparação: Scala → performance e robustez; PySpark → facilidade e ecossistema Python.</li>
  </ul>

  <h4>Próximos Magias a Desvendar... 🗺️✨</h4>
  <ul>
    <li>Explorar Julia (performance numérica).</li>
    <li>Comparar Scala com outras linguagens em Big Data.</li>
    <li>Ver como Scala se encaixa na automação e arquiteturas avançadas.</li>
  </ul>
  <p>
    Continue aprendendo novas línguas de dados! Cada nova língua abre portas para soluções mais poderosas, Desbravador(a)! 💪
  </p>
</div>
