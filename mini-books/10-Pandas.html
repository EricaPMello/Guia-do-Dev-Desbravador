<div class="minilivro" id="mini10">
  <h2>10 - Pandas: O BraÃ§o Direito do Desbravador na Limpeza e OrganizaÃ§Ã£o dos Dados ğŸ¼</h2>
  <p>
    Bem-vindo(a) de volta Ã  oficina, Desbravador(a)!
  </p>
  <p>
    Com nosso canivete suÃ­Ã§o Python (nosso kit bÃ¡sico) em mÃ£os e a chave mestra SQL para acessar dados, precisamos agora de uma ferramenta especializada para a tarefa mais comum e crucial no dia a dia: pegar aqueles dados em formato de tabela e limpÃ¡-los, organizÃ¡-los e preparÃ¡-los para anÃ¡lise!
  </p>
  <p>
    Ã‰ aÃ­ que entra o <strong>Pandas</strong>! Pense no Pandas como a bancada de trabalho robusta e super equipada da sua oficina Python, feita sob medida para lidar com dados em formato de tabela (como planilhas ou os resultados de uma query SQL). O mascote, o panda ğŸ¼, Ã© amigÃ¡vel e eficiente, assim como a biblioteca!
  </p>

  <h3>O Que Ã© Pandas? A Bancada Especializada! ğŸ› ï¸ğŸ¼</h3>
  <p>
    Pandas Ã© uma biblioteca Python. Lembra que falamos que bibliotecas sÃ£o conjuntos de ferramentas prontas? O Pandas Ã© a biblioteca para trabalhar com dados estruturados (dados que tÃªm colunas e linhas, como numa tabela).
  </p>
  <ul>
    <li><strong>Series:</strong> Ã‰ como uma Ãºnica coluna de uma tabela. Pense em uma lista de valores com um Ã­ndice (um rÃ³tulo ou nÃºmero) para cada valor.</li>
    <li><strong>DataFrame:</strong> Ã‰ a estrutura mais usada e poderosa. Pense nisso como uma tabela completa, uma coleÃ§Ã£o de Series (colunas) que compartilham o mesmo Ã­ndice (as linhas). Ã‰ exatamente como uma planilha Excel ou uma tabela SQL, mas dentro do Python!</li>
  </ul>
  <div class="analogia">
    <strong>Analogia:</strong> Se os dados brutos sÃ£o ingredientes ğŸ¥•, e Python Ã© a Oficina ğŸ­, o PANDAS Ã© a Bancada de Trabalho Especializada ğŸ› ï¸, com ferramentas para cortar, misturar, limpar e organizar seus ingredientes em porÃ§Ãµes (Series) e pratos arrumados (DataFrames).
  </div>
  <p><strong>Mental Trigger:</strong> PANDAS = A Bancada/BraÃ§o Direito para trabalhar com Tabelas de Dados no Python ğŸ¼ğŸ“„.</p>

  <h3>ComeÃ§ando com o Panda na Oficina!</h3>
  <p>Para usar o Pandas, vocÃª precisa "importar" a biblioteca, assim como pegar a ferramenta da gaveta:</p>
  <pre><code>import pandas as pd

print("Pandas pronto para trabalhar na sua oficina! ğŸ¼")</code></pre>

  <h4>DataFrame e Series: As Estruturas de Dados do Panda</h4>
  <p>Vamos ver como sÃ£o essas estruturas bÃ¡sicas na prÃ¡tica:</p>
  <pre><code># --- Exemplo de Series (Uma Coluna) ---
idades = [22, 35, 28, 41, 30]
serie_idades = pd.Series(idades, name="Idades dos Desbravadores") # Criamos uma Series a partir da lista

print("--- Nossa primeira Series (uma coluna de dados): ---")
print(serie_idades)
print("-" * 20)

# --- Exemplo de DataFrame (Uma Tabela) ---
dados_tesouro = {
    'Item': ['Moeda de Ouro', 'Pedra Rara', 'Mapa Antigo', 'Moeda de Prata'],
    'Quantidade': [150, 3, 1, 250],
    'Valor_Unitario': [10.5, 500.0, 1000.0, 5.0],
    'Encontrado_Em': ['Floresta', 'Caverna', 'Biblioteca', 'Floresta']
}
tabela_tesouro = pd.DataFrame(dados_tesouro)

print("\n--- Nosso primeiro DataFrame (uma tabela de dados): ---")
print(tabela_tesouro)
print("-" * 20)
</code></pre>

  <h4>Trazendo o Tesouro para a Bancada: Carregando Dados ğŸ“¥</h4>
  <p>Na vida real, seus dados nÃ£o estarÃ£o em dicionÃ¡rios Python, mas sim em arquivos (CSV, Excel, JSON) ou virÃ£o de bancos de dados (usando SQL!). Pandas facilita muito carregar esses dados para um DataFrame:</p>
  <pre><code># Imagine que vocÃª salvou os dados acima em um arquivo CSV chamado 'tesouro.csv'
# Item,Quantidade,Valor_Unitario,Encontrado_Em
# Moeda de Ouro,150,10.5,Floresta
# Pedra Rara,3,500.0,Caverna
# Mapa Antigo,1,1000.0,Biblioteca
# Moeda de Prata,250,5.0,Floresta

try:
    tesouro_df_csv = pd.read_csv('tesouro.csv')
    print("\n--- DataFrame carregado de um arquivo CSV: ---")
    print(tesouro_df_csv)
    print("-" * 20)
except FileNotFoundError:
    print("\nArquivo 'tesouro.csv' nÃ£o encontrado. NÃ£o foi possÃ­vel carregar de arquivo.")
    print("Por enquanto, imagine que o cÃ³digo acima carregaria a tabela mostrada antes.")
    print("-" * 20)
</code></pre>
  <p>Pandas tambÃ©m tem funÃ§Ãµes para ler outros formatos:</p>
  <ul>
    <li><code>pd.read_excel('meu_arquivo.xlsx')</code></li>
    <li><code>pd.read_json('meu_arquivo.json')</code></li>
    <li><code>pd.read_sql('SELECT * FROM minha_tabela', conexao_banco)</code> <!-- Sim! Roda SQL e traz pro DataFrame! --></li>
  </ul>
  <div class="analogia">
    <strong>Analogia:</strong> FunÃ§Ãµes como <code>pd.read_csv()</code> sÃ£o como o mecanismo que pega a caixa de ingredientes (o arquivo) e a despeja de forma organizada na sua bancada (o DataFrame).
  </div>

  <h4>Inspecionando o Tesouro na Bancada: Olhando Seus Dados ğŸ‘€</h4>
  <pre><code>print("\n--- Inspecionando o DataFrame: ---")

# .head() mostra as primeiras 5 linhas
print("\nPrimeiras 5 linhas (.head()):")
print(tabela_tesouro.head())

# .info() mostra um resumo
print("\nInformaÃ§Ãµes gerais (.info()):")
tabela_tesouro.info()

# .describe() mostra estatÃ­sticas descritivas
print("\nEstatÃ­sticas (.describe()):")
print(tabela_tesouro.describe())

# .shape mostra o nÃºmero de linhas e colunas
print(f"\nFormato do DataFrame (linhas, colunas): {tabela_tesouro.shape}")

# .columns mostra os nomes das colunas
print(f"\nNomes das colunas: {tabela_tesouro.columns}")
print("-" * 20)
</code></pre>
  <div class="analogia">
    <strong>Analogia:</strong> <code>head()</code>, <code>info()</code>, <code>describe()</code>, <code>shape</code>, <code>columns</code> sÃ£o como ferramentas de inspeÃ§Ã£o na bancada.
  </div>

  <h4>Selecionando Dados: Pegando os Ingredientes Certos ğŸ¤</h4>
  <pre><code># Selecionando apenas uma coluna (Series)
itens = tabela_tesouro['Item']
print("\n--- Selecionando a coluna 'Item': ---")
print(itens)
print(f"Tipo: {type(itens)}")
print("-" * 20)

# Selecionando mÃºltiplas colunas (DataFrame)
itens_e_quantidade = tabela_tesouro[['Item', 'Quantidade']]
print("\n--- Selecionando colunas 'Item' e 'Quantidade': ---")
print(itens_e_quantidade)
print(f"Tipo: {type(itens_e_quantidade)}")
print("-" * 20)

# Selecionando linhas por posiÃ§Ã£o (.iloc)
primeiro_item = tabela_tesouro.iloc[0]
duas_ultimas = tabela_tesouro.iloc[-2:]
print("\n--- Primeira linha (.iloc[0]): ---")
print(primeiro_item)
print("\n--- Duas Ãºltimas linhas (.iloc[-2:]): ---")
print(duas_ultimas)
print("-" * 20)

# Selecionando linhas por rÃ³tulo/condiÃ§Ã£o (.loc)
tesouros_da_floresta = tabela_tesouro.loc[tabela_tesouro['Encontrado_Em'] == 'Floresta']
print("\n--- Tesouros encontrados na Floresta (.loc com condiÃ§Ã£o): ---")
print(tesouros_da_floresta)
print("-" * 20)
</code></pre>
  <div class="analogia">
    <strong>Analogia:</strong> Selecionar dados com <code>[]</code>, <code>.loc</code> e <code>.iloc</code> Ã© como usar suas pinÃ§as na bancada para pegar exatamente os ingredientes de que precisa.
  </div>

  <h4>Limpeza de Dados: Lavando e Preparando os Ingredientes ğŸ§¼</h4>
  <pre><code># Dados bagunÃ§ados de exemplo
dados_baguncados = {
    'A': [1, 2, None, 4, 5],
    'B': ['X', 'Y', 'Y', 'X', None],
    'C': [True, False, True, True, False]
}
df_bagunca = pd.DataFrame(dados_baguncados)

print("\n--- DataFrame com bagunÃ§a (valores faltando, duplicados): ---")
print(df_bagunca)
print("-" * 20)

# Remover linhas com qualquer valor faltando
df_limpo_sem_faltantes = df_bagunca.dropna()
print("\n--- Depois de remover linhas com faltantes (.dropna()): ---")
print(df_limpo_sem_faltantes)
print("-" * 20)

# Preencher valores faltando
df_preenchido = df_bagunca.fillna({'A': 0, 'B': 'Desconhecido'})
print("\n--- Depois de preencher faltantes (.fillna()): ---")
print(df_preenchido)
print("-" * 20)

# Lidando com duplicados
dados_com_duplicados = {'ID': [1, 2, 2, 3], 'Valor': [100, 200, 200, 300]}
df_duplicados = pd.DataFrame(dados_com_duplicados)
print("\n--- DataFrame com duplicados: ---")
print(df_duplicados)
print("-" * 20)

df_sem_duplicados = df_duplicados.drop_duplicates()
print("\n--- Depois de remover duplicados (.drop_duplicates()): ---")
print(df_sem_duplicados)
print("-" * 20)

# Renomeando colunas
df_renomeado = tabela_tesouro.rename(columns={'Valor_Unitario': 'Valor_Unit'})
print("\n--- DataFrame com coluna renomeada (.rename()): ---")
print(df_renomeado)
print("-" * 20)
</code></pre>
  <div class="analogia">
    <strong>Analogia:</strong> <code>dropna()</code>, <code>fillna()</code>, <code>drop_duplicates()</code>, <code>rename()</code> sÃ£o suas ferramentas de limpeza e organizaÃ§Ã£o na bancada.
  </div>

  <h4>Agrupando e Agregando: Organizando por Tipo e Contando/Somando ğŸ§ºğŸ“ˆ</h4>
  <pre><code># Usando nosso DataFrame de tesouro (tabela_tesouro)
# Total de Quantidade e Valor_Unitario por local
total_por_local = tabela_tesouro.groupby('Encontrado_Em')[['Quantidade', 'Valor_Unitario']].sum()

print("\n--- Total de itens e valor por local (.groupby() e .sum()): ---")
print(total_por_local)
print("-" * 20)

# MÃ©dia de Quantidade por local
media_quantidade_por_local = tabela_tesouro.groupby('Encontrado_Em')['Quantidade'].mean()
print("\n--- MÃ©dia de Quantidade por local (.groupby() e .mean()): ---")
print(media_quantidade_por_local)
print("-" * 20)
</code></pre>
  <div class="analogia">
    <strong>Analogia:</strong> <code>groupby()</code> Ã© como separar ingredientes em pilhas por tipo; as funÃ§Ãµes de agregaÃ§Ã£o sÃ£o como contar ou tirar a mÃ©dia de cada pilha.
  </div>

  <h4>Um Caso de Uso na Bancada ğŸ¼ğŸ› ï¸</h4>
  <pre><code># Dados de vendas de exemplo
dados_vendas = {
    'Data': ['2023-10-01', '2023-10-01', '2023-10-02', '2023-10-02', '2023-10-03'],
    'Produto': ['A', 'B', 'A', 'C', 'B'],
    'Quantidade': [10, 5, 8, 12, 6],
    'Valor_Unitario': [15.0, 20.0, 15.0, 25.0, 20.0]
}
vendas_df = pd.DataFrame(dados_vendas)

# 1. Calcular o valor total de cada linha de venda
vendas_df['Valor_Total_Venda'] = vendas_df['Quantidade'] * vendas_df['Valor_Unitario']
print("\n--- DataFrame com a nova coluna 'Valor_Total_Venda': ---")
print(vendas_df)
print("-" * 20)

# 2. Agrupar por Produto e somar o 'Valor_Total_Venda'
total_por_produto = vendas_df.groupby('Produto')['Valor_Total_Venda'].sum()
print("\n--- Total de Vendas por Produto: ---")
print(total_por_produto)
print("-" * 20)

# Resultado:
# Produto
# A    270.0  (10*15 + 8*15)
# B    220.0  (5*20 + 6*20)
# C    300.0  (12*25)
</code></pre>
  <p>Este exemplo simples mostra como Pandas permite adicionar informaÃ§Ãµes e resumir dados rapidamente, passos comuns na anÃ¡lise.</p>

  <h3>Recapitulando o Panda na Bancada! ğŸ§ ğŸ¼</h3>
  <ul>
    <li><strong>Pandas:</strong> A Bancada Especializada / BraÃ§o Direito para Tabelas ğŸ› ï¸ğŸ¼</li>
    <li><strong>DataFrame:</strong> Uma Tabela/Planilha no Python ğŸ“„</li>
    <li><strong>Series:</strong> Uma Coluna da Tabela ğŸ“</li>
    <li><code>import pandas as pd</code>: Traz o Panda para a Oficina!</li>
    <li><code>pd.read_csv()</code>: Carrega dados de arquivos para a Bancada ğŸ“¥</li>
    <li><code>df.head()</code>, <code>info()</code>, <code>describe()</code>, <code>shape</code>, <code>columns</code>: Ferramentas de InspeÃ§Ã£o ğŸ‘€</li>
    <li>SeleÃ§Ã£o com <code>[]</code>, <code>.loc</code>, <code>.iloc</code>: Pegando partes dos dados ğŸ¤</li>
    <li><code>dropna()</code>, <code>fillna()</code>, <code>drop_duplicates()</code>, <code>rename()</code>: Limpando e Organizando ğŸ§¼</li>
    <li><code>groupby()</code> com agregaÃ§Ã£o (<code>.sum()</code>, <code>.mean()</code>): Organizando por grupo e resumindo ğŸ§ºğŸ“ˆ</li>
  </ul>

  <h4>PrÃ³ximos Passos com Nosso BraÃ§o Direito... ğŸ—ºï¸</h4>
  <p>
    Pandas Ã© GIGANTE! O que vimos Ã© sÃ³ a pontinha do iceberg. Nos prÃ³ximos capÃ­tulos, podemos explorar:
  </p>
  <ul>
    <li>Combinar DataFrames (os JOINs do SQL, mas no Pandas!)</li>
    <li>Mais tÃ©cnicas de limpeza e transformaÃ§Ã£o</li>
    <li>Trabalhar com dados de tempo (datas e horas)</li>
    <li>Como o Pandas se encaixa com outras bibliotecas Python (visualizaÃ§Ã£o com Matplotlib/Seaborn, Machine Learning com Scikit-learn)</li>
  </ul>
  <p>
    Continue praticando com o Pandas. Ele serÃ¡ seu companheiro constante na jornada de desbravar dados! ğŸ’ª
  </p>
</div>
